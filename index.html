<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>샘플 테스트</title>
    <script>
      // localStorage 접근을 완전히 차단하고 에러 억제
      (function() {
        'use strict';
        
        // localStorage와 sessionStorage를 완전히 차단
        const createFakeStorage = function() {
          const storage = {
            getItem: function() { return null; },
            setItem: function() {},
            removeItem: function() {},
            clear: function() {},
            length: 0,
            key: function() { return null; }
          };
          
          // Proxy로 모든 접근 차단
          return new Proxy(storage, {
            get: function(target, prop) {
              if (prop in target) {
                return target[prop];
              }
              return function() { return null; };
            },
            set: function() { return true; },
            has: function() { return true; },
            ownKeys: function() { return []; },
            getOwnPropertyDescriptor: function() {
              return { enumerable: false, configurable: false };
            }
          });
        };
        
        try {
          const fakeStorage = createFakeStorage();
          
          // localStorage 완전 차단
          Object.defineProperty(window, 'localStorage', {
            value: fakeStorage,
            writable: false,
            configurable: false,
            enumerable: false
          });
          
          // sessionStorage 완전 차단
          Object.defineProperty(window, 'sessionStorage', {
            value: fakeStorage,
            writable: false,
            configurable: false,
            enumerable: false
          });
          
          // Storage 생성자도 차단
          if (window.Storage) {
            Object.defineProperty(window, 'Storage', {
              value: function() { return fakeStorage; },
              writable: false,
              configurable: false
            });
          }
        } catch (e) {
          // 이미 정의되어 있으면 무시
        }
        
        // window.onerror로 동기 에러 처리 - storage 관련만 정확히 필터링
        const originalOnError = window.onerror;
        window.onerror = function(message, source, lineno, colno, error) {
          if (message && typeof message === 'string') {
            const msg = message.toLowerCase();
            // storage 관련 에러만 정확히 필터링
            if (
              msg.includes('storage is not allowed') ||
              msg.includes('access to storage') ||
              (msg.includes('localstorage') && msg.includes('not allowed')) ||
              (msg.includes('from this context') && msg.includes('storage'))
            ) {
              return true; // storage 관련 에러만 무시
            }
          }
          // 다른 에러는 표시됨
          if (originalOnError) {
            return originalOnError.call(this, message, source, lineno, colno, error);
          }
          return false;
        };
        
        // error 이벤트 리스너로 에러 처리 - storage 관련만 필터링
        window.addEventListener('error', function(event) {
          if (event.message) {
            const msg = event.message.toLowerCase();
            // storage 관련 에러만 정확히 필터링
            if (
              msg.includes('storage is not allowed') ||
              msg.includes('access to storage') ||
              (msg.includes('localstorage') && msg.includes('not allowed')) ||
              (msg.includes('from this context') && msg.includes('storage'))
            ) {
              event.preventDefault();
              event.stopPropagation();
              event.stopImmediatePropagation();
              return false;
            }
          }
          // 다른 에러는 표시됨
        }, true);
        
        // Promise rejection 처리 - storage 관련만 필터링 (더 강력하게)
        window.addEventListener('unhandledrejection', function(event) {
          if (!event || !event.reason) {
            return;
          }
          
          const reason = event.reason;
          let errorMessage = '';
          
          try {
            if (reason && typeof reason === 'object') {
              errorMessage = (reason.message || reason.toString() || '').toLowerCase();
            } else if (typeof reason === 'string') {
              errorMessage = reason.toLowerCase();
            }
          } catch (e) {
            // 에러 메시지 추출 실패 시 무시
            return;
          }
          
          // storage 관련 에러만 정확히 필터링
          if (
            errorMessage.includes('storage is not allowed') ||
            errorMessage.includes('access to storage') ||
            errorMessage.includes('not allowed from this context') ||
            (errorMessage.includes('localstorage') && errorMessage.includes('not allowed')) ||
            (errorMessage.includes('sessionstorage') && errorMessage.includes('not allowed')) ||
            (errorMessage.includes('from this context') && errorMessage.includes('storage'))
          ) {
            // 완전히 차단
            if (event.preventDefault) event.preventDefault();
            if (event.stopPropagation) event.stopPropagation();
            if (event.stopImmediatePropagation) event.stopImmediatePropagation();
            return true;
          }
          // 다른 에러는 표시됨
        }, true);
        
        // rejectionhandled 이벤트도 처리
        window.addEventListener('rejectionhandled', function(event) {
          // 이미 처리된 rejection도 무시
        }, true);
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>





